<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Verify</title>

  
<style>
  body {
    background: #111;
    color: #eee;
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    text-align: center;
  }

  h1 {
    margin-top: 30px;
  }

  p {
    max-width: 600px;
    margin: 10px auto;
    padding: 0 20px;
  }

  /* Camera circle */
  #camera-circle {
    width: min(80vw, 300px);
    height: min(80vw, 300px);
    border-radius: 50%;
    border: 4px solid #555;
    overflow: hidden;
    margin: 40px auto 20px;
    background: #000;
    position: relative;
  }

  video, canvas {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  button {
    margin-top: 20px;
    padding: 14px 28px;
    font-size: 18px;
    cursor: pointer;
    border-radius: 10px;
    border: none;
    background: #3498db;
    color: white;
  }

  /* Loading bar */
  #loader-container {
    width: 80%;
    max-width: 400px;
    height: 20px;
    background: #222;
    border: 2px solid #555;
    border-radius: 10px;
    margin: 30px auto;
    overflow: hidden;
    display: none;
  }

  #loader-bar {
    width: 0%;
    height: 100%;
    background: linear-gradient(90deg, #2ecc71, #27ae60);
  }

  #message {
    font-size: 22px;
    margin-top: 20px;
  }
</style>
</head>

<body>

<h1>Verify</h1>

<p>
  This is AI face verification to check your age.  
  Press the button to continue. If you do not press the button, you may be denied service.
</p>
<p>
  If the AI guesses wrong, refresh the page.
</p>
<p>
  Make sure your face is a well-lit area, with only one person in the photo.
</p>

<div id="camera-circle">
  <video id="video" autoplay playsinline></video>
  <canvas id="canvas" hidden></canvas>
</div>

<button id="actionButton" onclick="handleClick()">Start Verification</button>

<div id="loader-container">
  <div id="loader-bar"></div>
</div>

<div id="message"></div>

<script>
  const video = document.getElementById("video");
  const canvas = document.getElementById("canvas");
  const loader = document.getElementById("loader-container");
  const bar = document.getElementById("loader-bar");
  const message = document.getElementById("message");
  const button = document.getElementById("actionButton");

  let stream = null;
  let cameraStarted = false;

  function handleClick() {
    if (!cameraStarted) {
      requestCamera();
    } else {
      takePhoto();
    }
  }

  function requestCamera() {
    navigator.mediaDevices.getUserMedia({ video: true })
      .then(s => {
        stream = s;
        video.srcObject = stream;
        cameraStarted = true;
        button.textContent = "Take Photo";
      })
      .catch(() => {
        alert("Camera permission is required to continue.");
      });
  }

  function takePhoto() {
    const ctx = canvas.getContext("2d");
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;

    ctx.drawImage(video, 0, 0);

    video.hidden = true;
    canvas.hidden = false;

    // Stop camera after capture
    stream.getTracks().forEach(track => track.stop());

    button.disabled = true;
    startLoading();
  }

  function startLoading() {
    loader.style.display = "block";
    let progress = 0;

    const interval = setInterval(() => {
      progress++;
      bar.style.width = progress + "%";

      if (progress >= 100) {
        clearInterval(interval);
        showMessage();
      }
    }, 100); // 100ms Ã— 100 = 10 seconds
  }

  function showMessage() {
    const texts = [
      "AI guessed age is: 15-16. Please use a different AI, you are too young to use ChatGPT.",
      "AI gussed age is: 65+. Please use a different AI, you are too old to use ChatGPT."
    ];

    message.textContent =
      texts[Math.floor(Math.random() * texts.length)];
  }
</script>

</body>
</html>
