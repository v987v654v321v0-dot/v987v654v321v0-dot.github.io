<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>upView Playground</title>

<style>
:root {
  --bg: #0f1220;
  --panel: #151933;
  --panel-light: #1c2147;
  --accent: #6c7cff;
  --text: #eaeaf0;
  --muted: #aab;
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  font-family: Inter, system-ui, sans-serif;
  height: 100vh;
  display: flex;
  flex-direction: column;
  background: var(--bg);
  color: var(--text);
}

/* ─── Top Bar ───────────────────── */
#topbar {
  padding: 12px 16px;
  background: linear-gradient(90deg, #141833, #1a1f4a);
  display: flex;
  gap: 10px;
  align-items: center;
  box-shadow: 0 2px 10px rgba(0,0,0,0.4);
}

#topbar button {
  padding: 8px 14px;
  font-size: 14px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  background: var(--accent);
  color: white;
  font-weight: 600;
  transition: transform 0.1s ease, opacity 0.2s;
}

#topbar button:hover {
  transform: translateY(-1px);
}

#topbar button:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

/* ─── AI Prompt Box ─────────────── */
#aiBox {
  width: 100%;
  border: none;
  padding: 12px 14px;
  font-size: 14px;
  outline: none;
  background: var(--panel-light);
  color: var(--text);
  border-bottom: 1px solid rgba(255,255,255,0.06);
}

/* ─── Loading Bar ─────────────── */
#loadingBar {
  height: 4px;
  width: 100%;
  background: rgba(255,255,255,0.08);
  overflow: hidden;
  display: none;
}

#loadingBar::before {
  content: "";
  display: block;
  height: 100%;
  width: 40%;
  background: linear-gradient(
    90deg,
    transparent,
    var(--accent),
    transparent
  );
  animation: loading 1.1s infinite ease-in-out;
}

@keyframes loading {
  from { transform: translateX(-100%); }
  to   { transform: translateX(250%); }
}

/* ─── Main Layout ─────────────── */
#main {
  flex: 1;
  display: flex;
}

/* ─── Editors ─────────────── */
textarea {
  width: 50%;
  border: none;
  padding: 14px;
  font-family: "Roboto Mono", monospace;
  font-size: 14px;
  outline: none;
  resize: none;
  background: var(--panel);
  color: var(--text);
  border-right: 1px solid rgba(255,255,255,0.06);
}

iframe {
  width: 50%;
  border: none;
  background: white;
}
</style>
</head>
<body>

<div id="topbar">
  <button onclick="run()">Execute</button>
  <button id="aiBtn" onclick="runAI()">AI Generate</button>
</div>

<textarea id="aiBox" placeholder="Describe what you want the AI to build (e.g. Make a title and a button that alerts Hello)"></textarea>
<div id="loadingBar"></div>

<div id="main">
  <textarea id="input">
<caption> 1 Hello
<text>: This is upView

<button>: Click me
<code>: {
btn.previous.mouseclick.connect:alert: Hello from upScript!
}
  </textarea>

  <iframe id="output"></iframe>
</div>

<script>
const BASE_URL = "https://crimson-credit-f0fa.v987v654v321v0.workers.dev";
const loadingBar = document.getElementById("loadingBar");
const aiBtn = document.getElementById("aiBtn");

async function run() {
  const code = document.getElementById("input").value;

  const response = await fetch(BASE_URL, {
    method: "POST",
    headers: { "Content-Type": "text/plain" },
    body: code
  });

  const html = await response.text();
  document.getElementById("output").srcdoc = html;
}

async function runAI() {
  const prompt = document.getElementById("aiBox").value;

  if (!prompt.trim()) {
    alert("Enter an AI prompt first.");
    return;
  }

  loadingBar.style.display = "block";
  aiBtn.disabled = true;
  aiBtn.textContent = "Generating…";

  try {
    const response = await fetch(BASE_URL + "/ai", {
      method: "POST",
      headers: { "Content-Type": "text/plain" },
      body: prompt
    });

    const html = await response.text();
    document.getElementById("output").srcdoc = html;
  } finally {
    loadingBar.style.display = "none";
    aiBtn.disabled = false;
    aiBtn.textContent = "AI Generate";
  }
}
</script>

</body>
</html>
